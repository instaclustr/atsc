# BRRO Compressor

Version: 0.2 Released: 23/10/2023

## Description

BRRO Compressor is a compressor that relies on the characterists of a signal to provide a far greater compression that currently existing ones. BRRO relies on different techniques based on a initial analysis of the signal to use the best suited method for compressor for that specific signal segment.

For a detailed description on the compressor methods and logic check `BRRO.md`.

## Usage

Currently BRRO relies on have Raw BRRO files generated by our prometheus remote endpoint. This would work as input for the compressor.

Compressor usage:

```An Advanced Time-Series Compressor

Usage: brro-compressor [OPTIONS] <INPUT>

Arguments:
  <INPUT>  input file

Options:
      --compressor <COMPRESSOR>  [default: noop] [possible values: noop, fft, wavelet, constant, polynomial, top-bottom]
  -u                             Uncompresses the input file/directory
  -h, --help                     Print help
  -V, --version                  Print version
  ```

## Programs and description

This repository contains one main program and other programs that serve different purposes, some are for just testing, others do some actual work.

### flac-server

**NOTE**: Remote read is currently NOT working, as it depends on FLAC files that are no longer generated.

Needs a prometheus server. We need it to get our samples out. Supports read and write from prometheus.

Launch the `flac-server` and set it as your remote endpoint for prometheus, example below.

```
# Remote read and Write
remote_write:
   - url: "http://localhost:9201/api/write"

remote_read:
   - url: "http://localhost:9201/api/read"
     read_recent: true
     name: "flac_server"
```

Make Prometheus server a source of your grafana and check the data.

### brro_optimizer

Maybe the most important tool at this point, it picks a WAV file from the datasets described below and optimizes it into a way that we might see a meaning full compression into FLAC.
The tool also has options to dump the output of the file as a single sample per period, instead of the 4 channels. This is good to obtain the data as it was feed into the flac-server.
The code performs optimizations based on file name, so renaming might cause issues.

Usage (Getting raw samples): `./brro_optimizer infile.wav --dump-raw > file.raw`
Usage (Getting optimized samples): `./brro_optimizer infile.wav --dump-optimized > file.raw`
Usage (Generate a optimized file): `./brro_optimizer -w infile.wav`

If you set the ENV Variable for Debug it will output what it is doing.

### Matlab folder

Exploratory code. Should be removed.

## TODO

1. Update `flac-server` to read cBRRO files.
